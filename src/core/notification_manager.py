import logging
from src.core.database import DatabaseManager
from telegram import Bot

class NotificationManager:
    def __init__(self, db: DatabaseManager, bot: Bot = None):
        self.db = db
        self.bot = bot
        self._logger = logging.getLogger(__name__)

    async def send_notification(self, user_id: int, message: str) -> bool:
        """–û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
        try:
            if self.bot:
                await self.bot.send_message(chat_id=user_id, text=message)
            return True
        except Exception as e:
            self._logger.error(f"Failed to send notification: {e}")
            return False

    async def notify_coordinator_request_status(self, user_id: int, approved: bool):
        """–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –∑–∞—è–≤–∫–∏ –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞"""
        if approved:
            message = (
                "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—É—Å –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ –æ–¥–æ–±—Ä–µ–Ω–∞!\n\n"
                "üìù –ü—Ä–∞–≤–∏–ª–∞ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞:\n"
                "1. –í—ã –Ω–µ—Å–µ—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏ —É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.\n"
                "2. –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏.\n"
                "3. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ —Å–≤—è–∑—å —Å–æ –≤—Å–µ–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –≥—Ä—É–ø–ø—ã.\n"
                "4. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –æ—Ç—á–µ—Ç—ã –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ.\n\n"
                "‚ö†Ô∏è –≠—Ç–æ –±–æ–ª—å—à–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. –ú—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –≤—ã —Å–ø—Ä–∞–≤–∏—Ç–µ—Å—å!"
            )
        else:
            message = (
                "üòï –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—É—Å –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞.\n\n"
                "‚ö†Ô∏è –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ —Ç—Ä–µ–±—É–µ—Ç –æ–ø—ã—Ç–∞ —Ä–∞–±–æ—Ç—ã –≤ –ø–æ–∏—Å–∫–æ–≤–æ-—Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö.\n"
                "–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —É—á–∞—Å—Ç–∏–µ –≤ –ø–æ–∏—Å–∫–∞—Ö –∏ –Ω–∞–±—Ä–∞—Ç—å—Å—è –æ–ø—ã—Ç–∞.\n\n"
                "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ–µ–∫—Ç–∞! üöëüîç"
            )
        
        await self.send_notification(user_id, message)
